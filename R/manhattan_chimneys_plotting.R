source('/Volumes/Temp/Lukas/Tools/Scripts/R/manhattan_plot_all_chromosomes_function_qqplot.R')
setwd("/Volumes/Temp/Lukas/Data/Chimneys")
chroms=c('Dsim_M252_draft_4_2L', 'Dsim_M252_draft_4_2R', 'Dsim_M252_draft_4_3L', 'Dsim_M252_draft_4_3R', 'Dsim_M252_draft_4_4', 'Dsim_M252_draft_4_U', 'Dsim_M252_draft_4_X')
data <- read.table("150113_BaseV59_medMin.cmh_nlp3.gwas", header=TRUE)
data$ID <- paste(data$CHR,data$BP,sep="_")
quartz(height=6,width=12)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2L')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys=read.table("150113_BaseV59_medMin.cmh.L2.chim")
names(chimneys)=c('CHR','BP','A_log','A_ln')
points(chimneys$BP,chimneys$A_ln,pch=".",cex=2,col="red")
points(chimneys$BP,chimneys$A_log,pch=".",cex=2,col="green")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5kb")
legend(0,25, c("ln","log10"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green"))
dev.print(png,width=1024,file="hc_bv59_2L_chim_5kb_log_ln.png")

chimneys10kb=read.table("150113_BaseV59_medMin_2L.cmh_ws10kb")
chimneys50kb=read.table("150113_BaseV59_medMin_2L.cmh_ws50kb")
names(chimneys10kb)=c('CHR','BP','A_log','A_ln')
names(chimneys50kb)=c('CHR','BP','A_log','A_ln')
par(bg="white")
quartz(height=6,width=12)
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
points(chimneys$BP,chimneys$A_ln,pch=".",cex=2,col="red")
points(chimneys10kb$BP,chimneys10kb$A_ln,pch=".",cex=2,col="green")
points(chimneys50kb$BP,chimneys50kb$A_ln,pch=".",cex=2,col="blue")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5,10,50kb")
legend(0,25, c("5 kb window size","10 kb window size","50 kb window size"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green","blue"))
dev.print(png,width=1024,file="hc_bv59_2L_chim_5_10_50_kb_ln.png")

quartz(height=6,width=12)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys=read.table("150113_BaseV59_medMin.cmh.chim")
names(chimneys)=c('CHR','BP','A_log','A_ln')
points(chimneys$BP,chimneys$A_ln,pch=".",cex=2,col="red")
points(chimneys$BP,chimneys$A_log,pch=".",cex=2,col="green")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5kb")
legend(0,25, c("ln","log10"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_5kb_log_ln.png")

quartz(height=6,width=12)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_rank.chim")
names(chimneys)=c('CHR','BP','A_ln','A_w')
points(chimneys$BP,chimneys$A_w,pch=".",cex=2,col="green")
points(chimneys$BP,chimneys$A_ln,pch=".",cex=2,col="red")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5kb")
legend(0,25, c("non weighted ln","ln weigthed by rank"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_5kb_ln_w.png")


chimneys10kb=read.table("150113_BaseV59_medMin_2R.cmh_ws10kb_rank.chim")
chimneys50kb=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_rank.chim")
names(chimneys10kb)=c('CHR','BP','A_ln','A_w')
names(chimneys50kb)=c('CHR','BP','A_ln','A_w')
quartz(height=10,width=18)
par(bg="white")
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
points(chimneys$BP,chimneys$A_w,pch=".",cex=2,col="red")
points(chimneys10kb$BP,chimneys10kb$A_w,pch=".",cex=2,col="green")
points(chimneys50kb$BP,chimneys50kb$A_w,pch=".",cex=2,col="blue")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5,10,50kb, weighted by rank")
legend(0,25, c("5 kb window size","10 kb window size","50 kb window size"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green","blue"))
dev.print(png,width=1024,file="hc_bv59_2L_chim_5_10_50_kb_wght.png")

quartz(height=10,width=18)
par(bg="white")
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
points(chimneys$BP,chimneys$A_ln,pch=".",cex=2,col="red")
points(chimneys10kb$BP,chimneys10kb$A_ln,pch=".",cex=2,col="green")
points(chimneys50kb$BP,chimneys50kb$A_ln,pch=".",cex=2,col="blue")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5,10,50kb, squared ln")
legend(0,25, c("5 kb window size","10 kb window size","50 kb window size"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green","blue"))
dev.print(png,width=1024,file="hc_bv59_2L_chim_5_10_50_kb_sqln.png")

quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_q.chim")
names(chimneys)=c('CHR','BP','A_ln','A_q')
points(chimneys$BP,chimneys$A_q,pch=".",cex=2,col="green")
points(chimneys$BP,chimneys$A_ln,pch=".",cex=2,col="red")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5kb")
legend(0,25, c("non weighted ln","best 0.25 pVals only"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_5kb_ln_q25.png")

chimneys10kb=read.table("150113_BaseV59_medMin_2R.cmh_ws10kb_qu.chim")
chimneys50kb=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_qu.chim")
names(chimneys10kb)=c('CHR','BP','A_ln','A_q')
names(chimneys50kb)=c('CHR','BP','A_ln','A_q')
quartz(height=10,width=18)
par(bg="white")
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
points(chimneys$BP,chimneys$A_q/2,pch=".",cex=2,col="red")
points(chimneys10kb$BP,chimneys10kb$A_q/2,pch=".",cex=2,col="green")
points(chimneys50kb$BP,chimneys50kb$A_q/2,pch=".",cex=2,col="blue")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5,10,50kb, only best 0.25")
legend(0,25, c("5 kb window size","10 kb window size","50 kb window size"), lty=c(3,3),cex=1,lw=c(2,2),col=c("red","green","blue"))
dev.print(png,width=1024,file="hc_bv59_2L_chim_5_10_50_kb_qu25.png")

quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys075=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_qu0.75.chim")
chimneys025=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_qu0.25.chim")
chimneys05=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_qu0.5.chim")
names(chimneys075)=c('CHR','BP','A_ln','A_q')
names(chimneys05)=c('CHR','BP','A_ln','A_q')
names(chimneys025)=c('CHR','BP','A_ln','A_q')
points(chimneys025$BP,chimneys025$A_q/2,pch=".",cex=2,col="red")
points(chimneys05$BP,chimneys05$A_q/2,pch=".",cex=2,col="green")
points(chimneys075$BP,chimneys075$A_q/2,pch=".",cex=2,col="blue")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5kb")
legend(0,25, c("best 0.75","best 0.5","best 0.25"), lty=c(3,3),cex=1,lw=c(2,2),col=c("blue","green","red"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_5kb_ln_q025_05_075.png")
quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys075=read.table("150113_BaseV59_medMin_2R.cmh_ws20kb_qu0.75.chim")
chimneys025=read.table("150113_BaseV59_medMin_2R.cmh_ws20kb_qu0.25.chim")
chimneys05=read.table("150113_BaseV59_medMin_2R.cmh_ws20kb_qu0.5.chim")
names(chimneys075)=c('CHR','BP','A_ln','A_q')
names(chimneys05)=c('CHR','BP','A_ln','A_q')
names(chimneys025)=c('CHR','BP','A_ln','A_q')
points(chimneys025$BP,chimneys025$A_q/2,pch=".",cex=2,col="red")
points(chimneys05$BP,chimneys05$A_q/2,pch=".",cex=2,col="green")
points(chimneys075$BP,chimneys075$A_q/2,pch=".",cex=2,col="blue")
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 20kb")
legend(0,25, c("best 0.75","best 0.5","best 0.25"), lty=c(3,3),cex=1,lw=c(2,2),col=c("blue","green","red"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_20kb_ln_q025_05_075.png")

quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys075=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_qu0.75.chim")
chimneys025=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_qu0.25.chim")
chimneys05=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_qu0.5.chim")
names(chimneys075)=c('CHR','BP','A_ln','A_q')
names(chimneys05)=c('CHR','BP','A_ln','A_q')
names(chimneys025)=c('CHR','BP','A_ln','A_q')
points(chimneys025$BP,chimneys025$A_q/2,pch=".",cex=2,col="red")
points(chimneys05$BP,chimneys05$A_q/2,pch=".",cex=2,col="green")
points(chimneys075$BP,chimneys075$A_q/2,pch=".",cex=2,col="blue")
lines(c(5.0e06,5.0e06+50000),c(20,20),col="black",cex=2,lty=1)
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 50kb")
legend(0,25, c("best 0.75","best 0.5","best 0.25"), lty=c(3,3),cex=1,lw=c(2,2),col=c("blue","green","red"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_50kb_ln_q025_05_075.png")

quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys075=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_qu0.75_w.chim")
chimneys025=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_qu0.25_w.chim")
chimneys05=read.table("150113_BaseV59_medMin_2R.cmh_ws50kb_qu0.5_w.chim")
names(chimneys075)=c('CHR','BP','A_ln','A_q')
names(chimneys05)=c('CHR','BP','A_ln','A_q')
names(chimneys025)=c('CHR','BP','A_ln','A_q')
points(chimneys025$BP,chimneys025$A_q/2,pch=".",cex=2,col="red")
points(chimneys05$BP,chimneys05$A_q/2,pch=".",cex=2,col="green")
points(chimneys075$BP,chimneys075$A_q/2,pch=".",cex=2,col="blue")
lines(c(5.0e06,5.0e06+50000),c(20,20),col="black",cex=2,lty=1)
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 50kb, weighted")
legend(0,25, c("best 0.75 weighted","best 0.5 weighted ","best 0.25 weighted"), lty=c(3,3),cex=1,lw=c(2,2),col=c("blue","green","red"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_50kb_ln_q025_05_075_weighted.png")

quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys075=read.table("150113_BaseV59_medMin_2R.cmh_ws20kb_qu0.75_w.chim")
chimneys025=read.table("150113_BaseV59_medMin_2R.cmh_ws20kb_qu0.25_w.chim")
chimneys05=read.table("150113_BaseV59_medMin_2R.cmh_ws20kb_qu0.5_w.chim")
names(chimneys075)=c('CHR','BP','A_ln','A_q')
names(chimneys05)=c('CHR','BP','A_ln','A_q')
names(chimneys025)=c('CHR','BP','A_ln','A_q')
points(chimneys025$BP,chimneys025$A_q/2,pch=".",cex=2,col="red")
points(chimneys05$BP,chimneys05$A_q/2,pch=".",cex=2,col="green")
points(chimneys075$BP,chimneys075$A_q/2,pch=".",cex=2,col="blue")
#lines(c(5.0e06,5.0e06+50000),c(20,20),col="black",cex=2,lty=1)
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 20kb, weighted")
legend(0,25, c("best 0.75 weighted","best 0.5 weighted ","best 0.25 weighted"), lty=c(3,3),cex=1,lw=c(2,2),col=c("blue","green","red"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_20kb_ln_q025_05_075_weighted.png")
quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys075=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_qu0.75_w.chim")
chimneys025=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_qu0.25_w.chim")
chimneys05=read.table("150113_BaseV59_medMin_2R.cmh_ws5kb_qu0.5_w.chim")
names(chimneys075)=c('CHR','BP','A_ln','A_q')
names(chimneys05)=c('CHR','BP','A_ln','A_q')
names(chimneys025)=c('CHR','BP','A_ln','A_q')
points(chimneys025$BP,chimneys025$A_q/2,pch=".",cex=2,col="red")
points(chimneys05$BP,chimneys05$A_q/2,pch=".",cex=2,col="green")
points(chimneys075$BP,chimneys075$A_q/2,pch=".",cex=2,col="blue")
#lines(c(5.0e06,5.0e06+50000),c(20,20),col="black",cex=2,lty=1)
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 5kb, weighted")
legend(0,25, c("best 0.75 weighted","best 0.5 weighted ","best 0.25 weighted"), lty=c(3,3),cex=1,lw=c(2,2),col=c("blue","green","red"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_5kb_ln_q025_05_075_weighted.png")
quartz(height=10,width=18)
par(bg="white")
chroms=c('Dsim_M252_draft_4_2R')
manhattan(data,colors=c("black","slategrey"),limitchromosomes=chroms,main="")
chimneys075=read.table("150113_BaseV59_medMin_2R.cmh_ws10kb_qu0.75_w.chim")
chimneys025=read.table("150113_BaseV59_medMin_2R.cmh_ws10kb_qu0.25_w.chim")
chimneys05=read.table("150113_BaseV59_medMin_2R.cmh_ws10kb_qu0.5_w.chim")
names(chimneys075)=c('CHR','BP','A_ln','A_q')
names(chimneys05)=c('CHR','BP','A_ln','A_q')
names(chimneys025)=c('CHR','BP','A_ln','A_q')
points(chimneys025$BP,chimneys025$A_q/2,pch=".",cex=2,col="red")
points(chimneys05$BP,chimneys05$A_q/2,pch=".",cex=2,col="green")
points(chimneys075$BP,chimneys075$A_q/2,pch=".",cex=2,col="blue")
#lines(c(5.0e06,5.0e06+50000),c(20,20),col="black",cex=2,lty=1)
title(main="testing chimneys for D. sim Hotcage BaseV59, windowsize 10kb, weighted")
legend(0,25, c("best 0.75 weighted","best 0.5 weighted ","best 0.25 weighted"), lty=c(3,3),cex=1,lw=c(2,2),col=c("blue","green","red"))
dev.print(png,width=1024,file="hc_bv59_2R_chim_10kb_ln_q025_05_075_weighted.png")
